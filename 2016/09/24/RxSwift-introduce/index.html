<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="swift," />





  <link rel="alternate" href="/atom.xml" title="jamy.gush" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="IntroductionRX是通过观察序列组成的异步和基于事件的程序，Rx 是Reactive Extensions的一部分，同系列的还有RXJava,RXJS等 RX系列。RX扩展了观察者模式,支持数据和事件序列，并增加了一些操作使得我们可以将这些序列组成在一起。 首先由一点要说明的是，RX是函数式的，也是响应式的，但并不是真正意义上的Functional Reactive Programmin">
<meta name="keywords" content="swift">
<meta property="og:type" content="article">
<meta property="og:title" content="RxSwift系列笔记-入门">
<meta property="og:url" content="http://yoursite.com/2016/09/24/RxSwift-introduce/index.html">
<meta property="og:site_name" content="jamy.gush">
<meta property="og:description" content="IntroductionRX是通过观察序列组成的异步和基于事件的程序，Rx 是Reactive Extensions的一部分，同系列的还有RXJava,RXJS等 RX系列。RX扩展了观察者模式,支持数据和事件序列，并增加了一些操作使得我们可以将这些序列组成在一起。 首先由一点要说明的是，RX是函数式的，也是响应式的，但并不是真正意义上的Functional Reactive Programmin">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/publishsubject.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/replaysubject.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/behaviorsubject.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/startwith.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/merge.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/zip.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/combinelatest.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/switch.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/map.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/flatmap.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/scan.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/filter.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/distinct.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/elementat.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/take.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/takelast.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/takeuntil.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/takeuntil.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/skip.png">
<meta property="og:image" content="http://reactivex.io/documentation/operators/images/skipWhile.c.png">
<meta property="og:image" content="http://reactivex.io/documentation/operators/images/to.c.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/reduce.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/concat.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/catch.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/catch.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/retry.png">
<meta property="og:updated_time" content="2018-02-06T10:15:31.842Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RxSwift系列笔记-入门">
<meta name="twitter:description" content="IntroductionRX是通过观察序列组成的异步和基于事件的程序，Rx 是Reactive Extensions的一部分，同系列的还有RXJava,RXJS等 RX系列。RX扩展了观察者模式,支持数据和事件序列，并增加了一些操作使得我们可以将这些序列组成在一起。 首先由一点要说明的是，RX是函数式的，也是响应式的，但并不是真正意义上的Functional Reactive Programmin">
<meta name="twitter:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/publishsubject.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2016/09/24/RxSwift-introduce/"/>





  <title>RxSwift系列笔记-入门 | jamy.gush</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">jamy.gush</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/09/24/RxSwift-introduce/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jamy_gu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jamy.gush">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">RxSwift系列笔记-入门</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-24T10:10:36+08:00">
                2016-09-24
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/09/24/RxSwift-introduce/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2016/09/24/RxSwift-introduce/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>RX是通过观察序列组成的异步和基于事件的程序，Rx 是Reactive Extensions的一部分，同系列的还有RXJava,RXJS等 <a href="http://reactivex.io/intro.html" target="_blank" rel="noopener">RX系列</a>。RX扩展了<a href="https://en.wikipedia.org/wiki/Observer_pattern" target="_blank" rel="noopener">观察者模式</a>,支持数据和事件序列，并增加了一些操作使得我们可以将这些序列组成在一起。</p>
<p>首先由一点要说明的是，RX是函数式的，也是响应式的，但并不是真正意义上的Functional Reactive Programming<a href="https://github.com/conal/talk-2015-essence-and-origins-of-frp" target="_blank" rel="noopener">FRP</a>。<br><a id="more"></a></p>
<h3 id="Why-RXswift"><a href="#Why-RXswift" class="headerlink" title="Why RXswift"></a>Why RXswift</h3><p>在我们平时的开发过程中，当处理事件响应的时候，我们通常会通过不同的方式去处理，如使用KVO,Delegate监听属性值变化，<code>@IBAction</code>处理handle事件。这几种不同的方式处理无疑增加了代码的复杂度，RXSwift和RAC提供了这样的解决方案：把事件的产生和响应处理统一。</p>
<h3 id="Concepts"><a href="#Concepts" class="headerlink" title="Concepts"></a>Concepts</h3><p><code>Observable</code>是观察者模式中的被观察者对象，相当于一个事件<code>Sequence</code>序列，swift的<code>Sequence</code>可以异步的接收元素，这是RXSwift的本质，其他的都是基于这个扩展的。<code>observer</code>是观察者模式中的观察者对象(subscribers订阅者)。这两个是一一对应的，可观察者序列里面的闭包要有观察者订阅的时候才执行,但是如果有订阅者订阅了该信号，则会执行相应的闭包，订阅者就可以接收信号：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">example(&quot;Observable with subscriber&quot;) &#123;</span><br><span class="line">  _ = Observable&lt;String&gt;.create &#123; observerOfString in</span><br><span class="line">            print(&quot;Observable created&quot;)</span><br><span class="line">            observerOfString.on(.next(&quot;😉&quot;))</span><br><span class="line">            observerOfString.on(.completed)</span><br><span class="line">            return Disposables.create()</span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe &#123; event in</span><br><span class="line">            print(event)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">--- Observable with subscriber example ---</span><br><span class="line">Observable created</span><br><span class="line">next(😉)</span><br><span class="line">completed</span><br></pre></td></tr></table></figure>
<p>事件信息主要分为下面3种：</p>
<ul>
<li>.Next(Element) 表示新的事件序列。</li>
<li>.Completed 表示事件序列的结束。</li>
<li>.Error 表示异常发生导致的序列结束。</li>
</ul>
<h2 id="创建和订阅Observable"><a href="#创建和订阅Observable" class="headerlink" title="创建和订阅Observable"></a>创建和订阅<code>Observable</code></h2><h3 id="never"><a href="#never" class="headerlink" title="never"></a><code>never</code></h3><p>创建一个不会发送任何信号和结束的序列：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;never&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    let neverSequence = Observable&lt;String&gt;.never()</span><br><span class="line">    </span><br><span class="line">    let neverSequenceSubscription = neverSequence</span><br><span class="line">        .subscribe &#123; _ in</span><br><span class="line">            print(&quot;This will never be printed&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    neverSequenceSubscription.addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">&gt; nothing</span><br></pre></td></tr></table></figure>
<h3 id="empty"><a href="#empty" class="headerlink" title="empty"></a><code>empty</code></h3><p>创建一个空的序列，只发送.completed信号：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;empty&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable&lt;Int&gt;.empty()</span><br><span class="line">        .subscribe &#123; event in</span><br><span class="line">            print(event)</span><br><span class="line">        &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">&gt; completed</span><br></pre></td></tr></table></figure>
<h3 id="just"><a href="#just" class="headerlink" title="just"></a><code>just</code></h3><p>创建一个只包含一个元素的序列，它会先发送 .Next(Element) ，然后发送 .Completed：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;just&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.just(&quot;🔴&quot;)</span><br><span class="line">        .subscribe &#123; event in</span><br><span class="line">            print(event)</span><br><span class="line">        &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- just example ---</span><br><span class="line">next(🔴)</span><br><span class="line">completed</span><br></pre></td></tr></table></figure>
<h3 id="of"><a href="#of" class="headerlink" title="of"></a><code>of</code></h3><p>创建一个包含固定元素的序列：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;of&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.of(&quot;🐶&quot;, &quot;🐱&quot;, &quot;🐭&quot;, &quot;🐹&quot;)</span><br><span class="line">        .subscribe(onNext: &#123; element in</span><br><span class="line">            print(element)</span><br><span class="line">        &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- of example ---</span><br><span class="line">🐶</span><br><span class="line">🐱</span><br><span class="line">🐭</span><br><span class="line">🐹</span><br></pre></td></tr></table></figure>
<p>我们注意到订阅信号的时候没有使用之前的闭包，而是使用了<code>subscribe(onNext:)</code>便捷方法，之前的<code>subscribe(_:)</code>可以处理所有的事件类型(next,error,completed)，但是<code>subscribe(onNext:)</code>只会处理next事件，而忽略其他的事件。同理RXSwift还提供了<code>subscribe(onError:)</code>及<code>subscribe(onCompleted:)</code>快捷方法。</p>
<h3 id="from"><a href="#from" class="headerlink" title="from"></a><code>from</code></h3><p>把swift中的<code>Sequence</code>( <code>Array</code>, <code>Dictionary</code>,  <code>Set</code>)转化为事件序列，关于<code>Sequence</code>相关的介绍，请查看上一篇博客：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;from&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.from([&quot;🐶&quot;, &quot;🐱&quot;, &quot;🐭&quot;, &quot;🐹&quot;])</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- from example ---</span><br><span class="line">🐶</span><br><span class="line">🐱</span><br><span class="line">🐭</span><br><span class="line">🐹</span><br></pre></td></tr></table></figure>
<h3 id="create"><a href="#create" class="headerlink" title="create"></a><code>create</code></h3><p>可以通过create创建自定义的事件序列，在闭包里面通过.on方法添加事件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;create&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    let myJust = &#123; (element: String) -&gt; Observable&lt;String&gt; in</span><br><span class="line">        return Observable.create &#123; observer in</span><br><span class="line">            observer.on(.next(element))</span><br><span class="line">            observer.on(.completed)</span><br><span class="line">            return Disposables.create()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    myJust(&quot;🔴&quot;)</span><br><span class="line">        .subscribe &#123; print($0) &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- create example ---</span><br><span class="line">next(🔴)</span><br><span class="line">completed</span><br></pre></td></tr></table></figure>
<h3 id="range"><a href="#range" class="headerlink" title="range"></a><code>range</code></h3><p>创建一个可以发送一系列连续整数的时间序列，最后发送.completed事件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;range&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.range(start: 1, count: 10)</span><br><span class="line">        .subscribe &#123; print($0) &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- range example ---</span><br><span class="line">next(1)</span><br><span class="line">next(2)</span><br><span class="line">next(3)</span><br><span class="line">...</span><br><span class="line">completed</span><br></pre></td></tr></table></figure>
<h3 id="repeatElement"><a href="#repeatElement" class="headerlink" title="repeatElement"></a><code>repeatElement</code></h3><p>创建一个可以重复发送相同元素的事件序列：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;repeatElement&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.repeatElement(&quot;🔴&quot;)</span><br><span class="line">        .take(3)</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- repeatElement example ---</span><br><span class="line">🔴</span><br><span class="line">🔴</span><br><span class="line">🔴</span><br></pre></td></tr></table></figure>
<p>take操作返回指定数量的事件序列开始的元素。</p>
<h3 id="generate"><a href="#generate" class="headerlink" title="generate"></a><code>generate</code></h3><p>创建一个事件序列，发送到元素是符合指定的条件的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;generate&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.generate(</span><br><span class="line">            initialState: 0,</span><br><span class="line">            condition: &#123; $0 &lt; 3 &#125;,</span><br><span class="line">            iterate: &#123; $0 + 1 &#125;</span><br><span class="line">        )</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- generate example ---</span><br><span class="line">0</span><br><span class="line">1</span><br><span class="line">2</span><br></pre></td></tr></table></figure>
<h3 id="deferred"><a href="#deferred" class="headerlink" title="deferred"></a><code>deferred</code></h3><p>为每一个订阅者创建一个新的事件序列，就是说每个订阅者订阅的对象都是内容相同而完全独立的序列：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    var count = 1</span><br><span class="line">    </span><br><span class="line">    let deferredSequence = Observable&lt;String&gt;.deferred &#123;</span><br><span class="line">        print(&quot;Creating \(count)&quot;)</span><br><span class="line">        count += 1</span><br><span class="line">        </span><br><span class="line">        return Observable.create &#123; observer in</span><br><span class="line">            print(&quot;Emitting...&quot;)</span><br><span class="line">            observer.onNext(&quot;🐶&quot;)</span><br><span class="line">            observer.onNext(&quot;🐱&quot;)</span><br><span class="line">            observer.onNext(&quot;🐵&quot;)</span><br><span class="line">            return Disposables.create()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    deferredSequence</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">    </span><br><span class="line">    deferredSequence</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- deferred example ---</span><br><span class="line">Creating 1</span><br><span class="line">Emitting...</span><br><span class="line">🐶</span><br><span class="line">🐱</span><br><span class="line">🐵</span><br><span class="line">Creating 2</span><br><span class="line">Emitting...</span><br><span class="line">🐶</span><br><span class="line">🐱</span><br><span class="line">🐵</span><br></pre></td></tr></table></figure>
<h3 id="error"><a href="#error" class="headerlink" title="error"></a><code>error</code></h3><p>创建一个事件序列，不发送任何事件，而是直接返回.error然后结束。</p>
<h2 id="Subjects"><a href="#Subjects" class="headerlink" title="Subjects"></a>Subjects</h2><p>subject可以看做是一种桥梁或者代理。在RXSwift中它既可以作为被观察者也可以是观察者。这就意味着subject可以订阅其他<code>Observable</code>对象，同时也可以向订阅者发送事件序列<a href="http://reactivex.io/documentation/subject.html" target="_blank" rel="noopener">更多</a>。在开始介绍案例之前先定义如下方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">extension ObservableType &#123;</span><br><span class="line">    </span><br><span class="line">    /**</span><br><span class="line">     Add observer with `id` and print each emitted event.</span><br><span class="line">     - parameter id: an identifier for the subscription.</span><br><span class="line">     */</span><br><span class="line">    func addObserver(_ id: String) -&gt; Disposable &#123;</span><br><span class="line">        return subscribe &#123; print(&quot;Subscription:&quot;, id, &quot;Event:&quot;, $0) &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func writeSequenceToConsole&lt;O: ObservableType&gt;(name: String, sequence: O) -&gt; Disposable &#123;</span><br><span class="line">    return sequence.subscribe &#123; event in</span><br><span class="line">        print(&quot;Subscription: \(name), event: \(event)&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="PublishSubject"><a href="#PublishSubject" class="headerlink" title="PublishSubject"></a><code>PublishSubject</code></h3><p>向当前所有的订阅者发送新的事件，类似于广播~<br><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/publishsubject.png" alt="" title="PublishSubject"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;PublishSubject&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    let subject = PublishSubject&lt;String&gt;()</span><br><span class="line">    </span><br><span class="line">    subject.addObserver(&quot;1&quot;).addDisposableTo(disposeBag)</span><br><span class="line">    subject.onNext(&quot;🐶&quot;)</span><br><span class="line">    subject.onNext(&quot;🐱&quot;)</span><br><span class="line">    </span><br><span class="line">    subject.addObserver(&quot;2&quot;).addDisposableTo(disposeBag)</span><br><span class="line">    subject.onNext(&quot;🅰️&quot;)</span><br><span class="line">    subject.onNext(&quot;🅱️&quot;)</span><br><span class="line">&#125;</span><br><span class="line">--- PublishSubject example ---</span><br><span class="line">Subscription: 1 Event: next(🐶)</span><br><span class="line">Subscription: 1 Event: next(🐱)</span><br><span class="line">Subscription: 1 Event: next(🅰️)</span><br><span class="line">Subscription: 2 Event: next(🅰️)</span><br><span class="line">Subscription: 1 Event: next(🅱️)</span><br><span class="line">Subscription: 2 Event: next(🅱️)</span><br></pre></td></tr></table></figure>
<p>上面的事例中使用了<code>onNext(_:)</code>方法，等同于<code>on(.next(_:)</code>方法，向当前的订阅者发送一个next事件。类似的还有<code>onError(_:)</code> ,<code>onCompleted()</code>。</p>
<h3 id="ReplaySubject"><a href="#ReplaySubject" class="headerlink" title="ReplaySubject"></a><code>ReplaySubject</code></h3><p>和上面的<code>PublishSubject</code>类似，向所有的订阅者发送新的事件。不同的是<code>ReplaySubject</code>可以指定向新的订阅者发送之前的事件，参数<code>bufferSize</code>是缓冲区的大小，决定了补发事件的最大值：<br><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/replaysubject.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;ReplaySubject&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    let subject = ReplaySubject&lt;String&gt;.create(bufferSize: 1)</span><br><span class="line">    </span><br><span class="line">    subject.addObserver(&quot;1&quot;).addDisposableTo(disposeBag)</span><br><span class="line">    subject.onNext(&quot;🐶&quot;)</span><br><span class="line">    subject.onNext(&quot;🐱&quot;)</span><br><span class="line">    </span><br><span class="line">    subject.addObserver(&quot;2&quot;).addDisposableTo(disposeBag)</span><br><span class="line">    subject.onNext(&quot;🅰️&quot;)</span><br><span class="line">    subject.onNext(&quot;🅱️&quot;)</span><br><span class="line">&#125;</span><br><span class="line">--- ReplaySubject example ---</span><br><span class="line">Subscription: 1 Event: next(🐶)</span><br><span class="line">Subscription: 1 Event: next(🐱)</span><br><span class="line">Subscription: 2 Event: next(🐱)</span><br><span class="line">Subscription: 1 Event: next(🅰️)</span><br><span class="line">Subscription: 2 Event: next(🅰️)</span><br><span class="line">Subscription: 1 Event: next(🅱️)</span><br><span class="line">Subscription: 2 Event: next(🅱️)</span><br></pre></td></tr></table></figure>
<h3 id="BehaviorSubject"><a href="#BehaviorSubject" class="headerlink" title="BehaviorSubject"></a><code>BehaviorSubject</code></h3><p>也是向所有的订阅者发送新的事件，不同的是在新的订阅者订阅的时候会发送最近发送的事件，如果没有的话则发送默认值。<br><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/behaviorsubject.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;BehaviorSubject&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    let subject = BehaviorSubject(value: &quot;🔴&quot;)</span><br><span class="line">    </span><br><span class="line">    subject.addObserver(&quot;1&quot;).addDisposableTo(disposeBag)</span><br><span class="line">    subject.onNext(&quot;🐶&quot;)</span><br><span class="line">    subject.onNext(&quot;🐱&quot;)</span><br><span class="line">    </span><br><span class="line">    subject.addObserver(&quot;2&quot;).addDisposableTo(disposeBag)</span><br><span class="line">    subject.onNext(&quot;🅰️&quot;)</span><br><span class="line">    subject.onNext(&quot;🅱️&quot;)</span><br><span class="line">    </span><br><span class="line">    subject.addObserver(&quot;3&quot;).addDisposableTo(disposeBag)</span><br><span class="line">    subject.onNext(&quot;🍐&quot;)</span><br><span class="line">    subject.onNext(&quot;🍊&quot;)</span><br><span class="line">&#125;</span><br><span class="line">--- BehaviorSubject example ---</span><br><span class="line">Subscription: 1 Event: next(🔴)</span><br><span class="line">Subscription: 1 Event: next(🐶)</span><br><span class="line">Subscription: 1 Event: next(🐱)</span><br><span class="line">Subscription: 2 Event: next(🐱)</span><br><span class="line">Subscription: 1 Event: next(🅰️)</span><br><span class="line">Subscription: 2 Event: next(🅰️)</span><br><span class="line">Subscription: 1 Event: next(🅱️)</span><br><span class="line">Subscription: 2 Event: next(🅱️)</span><br><span class="line">Subscription: 3 Event: next(🅱️)</span><br><span class="line">Subscription: 1 Event: next(🍐)</span><br><span class="line">Subscription: 2 Event: next(🍐)</span><br><span class="line">Subscription: 3 Event: next(🍐)</span><br><span class="line">Subscription: 1 Event: next(🍊)</span><br><span class="line">Subscription: 2 Event: next(🍊)</span><br><span class="line">Subscription: 3 Event: next(🍊)</span><br></pre></td></tr></table></figure>
<p>在上面的几个案例中，好像结果少了一个<code>completed</code>事件， <code>PublishSubject</code>, <code>ReplaySubject</code>, <code>BehaviorSubject</code> 默认不发送<code>completed</code>事件。</p>
<h3 id="Variable"><a href="#Variable" class="headerlink" title="Variable"></a><code>Variable</code></h3><p><code>Variable</code>是基于<code>BehaviorSubject</code>的一层封装，所以也会向新的订阅者发送最近发送的事件，同样也维持当前值的状态。 <code>Variable</code>不会发送<code>Error</code>事件，但是会自动发送Completed事件并在<code>deinit</code>的时候释放。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;Variable&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    let variable = Variable(&quot;🔴&quot;)</span><br><span class="line">  variable.asObservable().addObserver(&quot;1&quot;).addDisposableTo(disposeBag)</span><br><span class="line">    variable.value = &quot;🐶&quot;</span><br><span class="line">    variable.value = &quot;🐱&quot;   </span><br><span class="line">  variable.asObservable().addObserver(&quot;2&quot;).addDisposableTo(disposeBag)</span><br><span class="line">    variable.value = &quot;🅰️&quot;</span><br><span class="line">    variable.value = &quot;🅱️&quot;</span><br><span class="line">&#125;</span><br><span class="line">--- Variable example ---</span><br><span class="line">Subscription: 1 Event: next(🔴)</span><br><span class="line">Subscription: 1 Event: next(🐶)</span><br><span class="line">Subscription: 1 Event: next(🐱)</span><br><span class="line">Subscription: 2 Event: next(🐱)</span><br><span class="line">Subscription: 1 Event: next(🅰️)</span><br><span class="line">Subscription: 2 Event: next(🅰️)</span><br><span class="line">Subscription: 1 Event: next(🅱️)</span><br><span class="line">Subscription: 2 Event: next(🅱️)</span><br><span class="line">Subscription: 1 Event: completed</span><br><span class="line">Subscription: 2 Event: completed</span><br></pre></td></tr></table></figure>
<p>在<code>Variable</code>实例中调用<code>asObservable()</code>方法可以访问<code>BehaviorSubject</code>事件序列，类似一个转换为可观察的作用。<code>Variable</code>没有实现on方法，但是提供了一个<code>value</code>方法，可以通过这个方法获取和设置当前的值，设置新值会添加到<code>BehaviorSubject</code>的事件队列中。</p>
<h2 id="Combination-Operators"><a href="#Combination-Operators" class="headerlink" title="Combination Operators"></a>Combination Operators</h2><p>RXSwift提供了下面几种方法，可以把几种序列组成一个新的序列。</p>
<h3 id="startWith"><a href="#startWith" class="headerlink" title="startWith"></a><code>startWith</code></h3><p>在发送<code>Observable</code>源事件之前，发送指定的事件序列元素。<br><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/startwith.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;startWith&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.of(&quot;🐶&quot;, &quot;🐱&quot;, &quot;🐭&quot;, &quot;🐹&quot;)</span><br><span class="line">        .startWith(&quot;1️⃣&quot;)</span><br><span class="line">        .startWith(&quot;2️⃣&quot;)</span><br><span class="line">        .startWith(&quot;3️⃣&quot;, &quot;🅰️&quot;, &quot;🅱️&quot;)</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- startWith example ---</span><br><span class="line">3️⃣</span><br><span class="line">🅰️</span><br><span class="line">🅱️</span><br><span class="line">2️⃣</span><br><span class="line">1️⃣</span><br><span class="line">🐶</span><br><span class="line">🐱</span><br><span class="line">🐭</span><br><span class="line">🐹</span><br></pre></td></tr></table></figure>
<p>从上面的例子可以看出，<code>startWith</code>可以在后进先出的基础上链接。</p>
<h3 id="merge"><a href="#merge" class="headerlink" title="merge"></a><code>merge</code></h3><p>把几个不同的<code>Observable</code>源序列中的元素组合成一个新的<code>Observable</code>源序列，新的<code>Observable</code>同样可以发送新的元素。<br><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/merge.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;merge&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    let subject1 = PublishSubject&lt;String&gt;()</span><br><span class="line">    let subject2 = PublishSubject&lt;String&gt;()</span><br><span class="line">    </span><br><span class="line">    Observable.of(subject1, subject2)</span><br><span class="line">        .merge()</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">    </span><br><span class="line">    subject1.onNext(&quot;🅰️&quot;)</span><br><span class="line">    </span><br><span class="line">    subject1.onNext(&quot;🅱️&quot;)</span><br><span class="line">    </span><br><span class="line">    subject2.onNext(&quot;①&quot;)</span><br><span class="line">    </span><br><span class="line">    subject2.onNext(&quot;②&quot;)</span><br><span class="line">    </span><br><span class="line">    subject1.onNext(&quot;🆎&quot;)</span><br><span class="line">    </span><br><span class="line">    subject2.onNext(&quot;③&quot;)</span><br><span class="line">&#125;</span><br><span class="line">--- merge example ---</span><br><span class="line">🅰️</span><br><span class="line">🅱️</span><br><span class="line">①</span><br><span class="line">②</span><br><span class="line">🆎</span><br><span class="line">③</span><br></pre></td></tr></table></figure>
<h3 id="zip"><a href="#zip" class="headerlink" title="zip"></a><code>zip</code></h3><p>把几种不同的<code>Observable</code>序列源组合成一个新的<code>Observable</code>序列源，最多可以组合8个。并将从复合<code>Observable</code>序列发送每个源对应索引在<code>Observable</code>序列的元素，每个源序列在索引上都要有元素才发送。<br><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/zip.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;zip&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    let stringSubject = PublishSubject&lt;String&gt;()</span><br><span class="line">    let intSubject = PublishSubject&lt;Int&gt;()</span><br><span class="line">    </span><br><span class="line">    Observable.zip(stringSubject, intSubject) &#123; stringElement, intElement in</span><br><span class="line">        &quot;\(stringElement) \(intElement)&quot;</span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">    </span><br><span class="line">    stringSubject.onNext(&quot;🅰️&quot;)</span><br><span class="line">    stringSubject.onNext(&quot;🅱️&quot;)</span><br><span class="line">    </span><br><span class="line">    intSubject.onNext(1)</span><br><span class="line">    </span><br><span class="line">    intSubject.onNext(2)</span><br><span class="line">    </span><br><span class="line">    stringSubject.onNext(&quot;🆎&quot;)</span><br><span class="line">    intSubject.onNext(3)</span><br><span class="line">&#125;</span><br><span class="line">--- zip example ---</span><br><span class="line">🅰️ 1</span><br><span class="line">🅱️ 2</span><br><span class="line">🆎 3</span><br></pre></td></tr></table></figure>
<h3 id="combineLatest"><a href="#combineLatest" class="headerlink" title="combineLatest"></a><code>combineLatest</code></h3><p>和<code>zip</code>方法类似，把几种不同的<code>Observable</code>序列源组合成一个新的<code>Observable</code>序列源，最多可以组合8个。不同的是序列发送的方式，<code>combineLatest</code>是当组合前的任何一个序列发送新的信号时，它都会组合每一个<code>Observable</code>最新的元素，然后发送。<br>如果存在两条事件队列，需要同时监听，那么每当有新的事件发生的时候，combineLatest 会将每个队列的最新的一个元素进行合并。<br><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/combinelatest.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;combineLatest&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    let stringSubject = PublishSubject&lt;String&gt;()</span><br><span class="line">    let intSubject = PublishSubject&lt;Int&gt;()</span><br><span class="line">    </span><br><span class="line">    Observable.combineLatest(stringSubject, intSubject) &#123; stringElement, intElement in</span><br><span class="line">            &quot;\(stringElement) \(intElement)&quot;</span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">    </span><br><span class="line">    stringSubject.onNext(&quot;🅰️&quot;)</span><br><span class="line">    stringSubject.onNext(&quot;🅱️&quot;)</span><br><span class="line">    intSubject.onNext(1)</span><br><span class="line">    intSubject.onNext(2)</span><br><span class="line">    stringSubject.onNext(&quot;🆎&quot;)</span><br><span class="line">&#125;</span><br><span class="line">--- combineLatest example ---</span><br><span class="line">🅱️ 1</span><br><span class="line">🅱️ 2</span><br><span class="line">🆎 2</span><br></pre></td></tr></table></figure>
<h3 id="switchLatest"><a href="#switchLatest" class="headerlink" title="switchLatest"></a><code>switchLatest</code></h3><p>变换由<code>Observable</code>序列发出的元素融入到<code>Observable</code>序列,只发送最新插入到序列里面的元素。<br> <img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/switch.png" alt=""></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> example(&quot;switchLatest&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    let subject1 = BehaviorSubject(value: &quot;⚽️&quot;)</span><br><span class="line">    let subject2 = BehaviorSubject(value: &quot;🍎&quot;)</span><br><span class="line">    </span><br><span class="line">    let variable = Variable(subject1)</span><br><span class="line">        </span><br><span class="line">    variable.asObservable()</span><br><span class="line">        .switchLatest()</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">    </span><br><span class="line">    subject1.onNext(&quot;🏈&quot;)</span><br><span class="line">    subject1.onNext(&quot;🏀&quot;)</span><br><span class="line">    </span><br><span class="line">    variable.value = subject2</span><br><span class="line">    </span><br><span class="line">    subject1.onNext(&quot;⚾️&quot;)</span><br><span class="line">    </span><br><span class="line">    subject2.onNext(&quot;🍐&quot;)</span><br><span class="line">&#125;</span><br><span class="line">--- switchLatest example ---</span><br><span class="line">⚽️</span><br><span class="line">🏈</span><br><span class="line">🏀</span><br><span class="line">🍎</span><br><span class="line">🍐</span><br></pre></td></tr></table></figure>
<p> 在上面的例子中，在设置<code>variable.value</code>=<code>subject2</code>之后，向<code>subject1</code>中添加⚾️元素是没有效果的，因为最新插入到序列里面的<code>subject2</code>才会发送元素。</p>
<h2 id="Transforming-Operators"><a href="#Transforming-Operators" class="headerlink" title="Transforming Operators"></a>Transforming Operators</h2><p>我们可以对序列做一些转换，类似于swift中的<code>squence</code>转换。</p>
<h3 id="map"><a href="#map" class="headerlink" title="map"></a><code>map</code></h3><p>对序列里面的每个元素进行转换。<br><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/map.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;map&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    Observable.of(1, 2, 3)</span><br><span class="line">        .map &#123; $0 * $0 &#125;</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- map example ---</span><br><span class="line">1</span><br><span class="line">4</span><br><span class="line">9</span><br></pre></td></tr></table></figure>
<h3 id="flatMap和flatMapLatest"><a href="#flatMap和flatMapLatest" class="headerlink" title="flatMap和flatMapLatest"></a><code>flatMap</code>和<code>flatMapLatest</code></h3><p>在swift中，flatmap可以过滤nil及降维作用（二维数组转换为一维数组）。在RXSwift中，flatmap可以把序列中的每个元素转换为<code>Observable</code>序列，然后再把这组序列转换为新的<code>Observable</code>序列。比如你有一个<code>Observable</code>序列，然后这个序列里面的元素同样也可以作为<code>Observable</code>序列，那么久可以使用<code>flatMap</code>进行转换。<code>flatMap</code>和<code>flatMapLatest</code>的区别主要是<code>flatMapLatest</code>只会对最后一个加入序列里面的元素进行操作。<br> <img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/flatmap.png" alt=""></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"> example(&quot;flatMap and flatMapLatest&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    struct Player &#123;</span><br><span class="line">        var score: Variable&lt;Int&gt;</span><br><span class="line">    &#125;</span><br><span class="line">    let 👦🏻 = Player(score: Variable(80))</span><br><span class="line">    let 👧🏼 = Player(score: Variable(90))</span><br><span class="line">    let player = Variable(👦🏻)</span><br><span class="line">    </span><br><span class="line">    player.asObservable()</span><br><span class="line">        .flatMap &#123; $0.score.asObservable() &#125; // Change flatMap to flatMapLatest and observe change in printed output</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">    </span><br><span class="line">    👦🏻.score.value = 85</span><br><span class="line">    player.value = 👧🏼</span><br><span class="line">    👦🏻.score.value = 95 // Will be printed when using flatMap, but will not be printed when using flatMapLatest</span><br><span class="line">    👧🏼.score.value = 100</span><br><span class="line">&#125;</span><br><span class="line">--- flatMap and flatMapLatest example ---</span><br><span class="line">80</span><br><span class="line">85</span><br><span class="line">90</span><br><span class="line">95</span><br><span class="line">100</span><br></pre></td></tr></table></figure>
<p> <code>flatMapLatest</code>实际上是<code>map</code>和<code>switchLatest</code>的组合操作。</p>
<h3 id="scan"><a href="#scan" class="headerlink" title="scan"></a><code>scan</code></h3><p><code>scan</code>和swift里面的reduce操作类似，传入一个初始值，每次的结果作为下一次的输入值。最后返回把结果作为一个<code>Observable</code>元素。<br><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/scan.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;scan&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.of(10, 100, 1000)</span><br><span class="line">        .scan(1) &#123; aggregateValue, newValue in</span><br><span class="line">            aggregateValue + newValue</span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- scan example ---</span><br><span class="line">11</span><br><span class="line">111</span><br><span class="line">1111</span><br></pre></td></tr></table></figure>
<h2 id="Filtering-and-Conditional"><a href="#Filtering-and-Conditional" class="headerlink" title="Filtering and Conditional"></a>Filtering and Conditional</h2><p>下面这些操作可以对元素进行过滤。</p>
<h3 id="filter"><a href="#filter" class="headerlink" title="filter"></a><code>filter</code></h3><p>和swift的操作一样，对元素进行过滤，返回符合闭包里面的元素。<br><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/filter.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;filter&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    Observable.of(</span><br><span class="line">        &quot;🐱&quot;, &quot;🐰&quot;, &quot;🐶&quot;,</span><br><span class="line">        &quot;🐸&quot;, &quot;🐱&quot;, &quot;🐰&quot;,</span><br><span class="line">        &quot;🐹&quot;, &quot;🐸&quot;, &quot;🐱&quot;)</span><br><span class="line">        .filter &#123;</span><br><span class="line">            $0 == &quot;🐱&quot;</span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- filter example ---</span><br><span class="line">🐱</span><br><span class="line">🐱</span><br><span class="line">🐱</span><br></pre></td></tr></table></figure>
<h3 id="distinctUntilChanged"><a href="#distinctUntilChanged" class="headerlink" title="distinctUntilChanged"></a><code>distinctUntilChanged</code></h3><p>禁止用<code>Observable</code>序列发送顺序重复元素,即他会抛弃相同的元素。<br><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/distinct.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;distinctUntilChanged&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.of(&quot;🐱&quot;, &quot;🐷&quot;, &quot;🐱&quot;, &quot;🐱&quot;, &quot;🐱&quot;, &quot;🐵&quot;, &quot;🐱&quot;)</span><br><span class="line">        .distinctUntilChanged()</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- distinctUntilChanged example ---</span><br><span class="line">🐱</span><br><span class="line">🐷</span><br><span class="line">🐱</span><br><span class="line">🐵</span><br><span class="line">🐱</span><br></pre></td></tr></table></figure>
<h3 id="elementAt"><a href="#elementAt" class="headerlink" title="elementAt"></a><code>elementAt</code></h3><p>只发送指定index的元素。<br><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/elementat.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;elementAt&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.of(&quot;🐱&quot;, &quot;🐰&quot;, &quot;🐶&quot;, &quot;🐸&quot;, &quot;🐷&quot;, &quot;🐵&quot;)</span><br><span class="line">        .elementAt(3)</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- elementAt example ---</span><br><span class="line">🐸</span><br></pre></td></tr></table></figure>
<h3 id="single"><a href="#single" class="headerlink" title="single"></a><code>single</code></h3><p>只发送第一个元素或者第一个符合闭包条件的元素。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;single with conditions&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.of(&quot;🐱&quot;, &quot;🐰&quot;, &quot;🐶&quot;, &quot;🐸&quot;, &quot;🐷&quot;, &quot;🐵&quot;)</span><br><span class="line">        .single &#123; $0 == &quot;🐸&quot; &#125;</span><br><span class="line">        .subscribe &#123; print($0) &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">    </span><br><span class="line">    Observable.of(&quot;🐱&quot;, &quot;🐰&quot;, &quot;🐶&quot;, &quot;🐱&quot;, &quot;🐰&quot;, &quot;🐶&quot;)</span><br><span class="line">        .single &#123; $0 == &quot;🐰&quot; &#125;</span><br><span class="line">        .subscribe &#123; print($0) &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">    </span><br><span class="line">    Observable.of(&quot;🐱&quot;, &quot;🐰&quot;, &quot;🐶&quot;, &quot;🐸&quot;, &quot;🐷&quot;, &quot;🐵&quot;)</span><br><span class="line">        .single &#123; $0 == &quot;🔵&quot; &#125;</span><br><span class="line">        .subscribe &#123; print($0) &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- single with conditions example ---</span><br><span class="line">next(🐸)</span><br><span class="line">completed</span><br><span class="line">next(🐰)</span><br><span class="line">error(Sequence contains more than one element.)</span><br><span class="line">error(Sequence doesn&apos;t contain any elements.)</span><br></pre></td></tr></table></figure>
<h3 id="take"><a href="#take" class="headerlink" title="take"></a><code>take</code></h3><p>只发送指定个数的元素。<br> <img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/take.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> example(&quot;take&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.of(&quot;🐱&quot;, &quot;🐰&quot;, &quot;🐶&quot;, &quot;🐸&quot;, &quot;🐷&quot;, &quot;🐵&quot;)</span><br><span class="line">        .take(3)</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- take example ---</span><br><span class="line">🐱</span><br><span class="line">🐰</span><br><span class="line">🐶</span><br></pre></td></tr></table></figure>
<h3 id="takeLast"><a href="#takeLast" class="headerlink" title="takeLast"></a><code>takeLast</code></h3><p>同<code>take</code>只发送指定个数的元素，不同的是它从序列的最后开始。<br><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/takelast.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;takeLast&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.of(&quot;🐱&quot;, &quot;🐰&quot;, &quot;🐶&quot;, &quot;🐸&quot;, &quot;🐷&quot;, &quot;🐵&quot;)</span><br><span class="line">        .takeLast(3)</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- takeLast example ---</span><br><span class="line">🐸</span><br><span class="line">🐷</span><br><span class="line">🐵</span><br></pre></td></tr></table></figure>
<h3 id="takeWhile"><a href="#takeWhile" class="headerlink" title="takeWhile"></a><code>takeWhile</code></h3><p>发送元素一直到闭包里面的条件为false。<br><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/takeuntil.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;takeWhile&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.of(1, 2, 3, 4, 5, 6)</span><br><span class="line">        .takeWhile &#123; $0 &lt; 4 &#125;</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- takeWhile example ---</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td></tr></table></figure>
<h3 id="takeUntil"><a href="#takeUntil" class="headerlink" title="takeUntil"></a><code>takeUntil</code></h3><p>以一个序列为参考，当参考序列发送元素时，当前的序列则停止发送元素。<br><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/takeuntil.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;takeUntil&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    let sourceSequence = PublishSubject&lt;String&gt;()</span><br><span class="line">    let referenceSequence = PublishSubject&lt;String&gt;()</span><br><span class="line">    </span><br><span class="line">    sourceSequence</span><br><span class="line">        .takeUntil(referenceSequence)</span><br><span class="line">        .subscribe &#123; print($0) &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">    </span><br><span class="line">    sourceSequence.onNext(&quot;🐱&quot;)</span><br><span class="line">    sourceSequence.onNext(&quot;🐰&quot;)</span><br><span class="line">    sourceSequence.onNext(&quot;🐶&quot;)</span><br><span class="line">    referenceSequence.onNext(&quot;🔴&quot;)</span><br><span class="line">    sourceSequence.onNext(&quot;🐸&quot;)</span><br><span class="line">    sourceSequence.onNext(&quot;🐷&quot;)</span><br><span class="line">    sourceSequence.onNext(&quot;🐵&quot;)</span><br><span class="line">&#125;</span><br><span class="line">--- takeUntil example ---</span><br><span class="line">next(🐱)</span><br><span class="line">next(🐰)</span><br><span class="line">next(🐶)</span><br><span class="line">completed</span><br></pre></td></tr></table></figure>
<h3 id="skip"><a href="#skip" class="headerlink" title="skip"></a><code>skip</code></h3><p>跳过发送指定个数的元素。从index为0开始计算。<br> <img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/skip.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;skip&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.of(&quot;🐱&quot;, &quot;🐰&quot;, &quot;🐶&quot;, &quot;🐸&quot;, &quot;🐷&quot;, &quot;🐵&quot;)</span><br><span class="line">        .skip(2)</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- skip example ---</span><br><span class="line">🐶</span><br><span class="line">🐸</span><br><span class="line">🐷</span><br><span class="line">🐵</span><br></pre></td></tr></table></figure>
<h3 id="skipWhile"><a href="#skipWhile" class="headerlink" title="skipWhile"></a><code>skipWhile</code></h3><p>禁止符合闭包条件的元素发送。<br> <img src="http://reactivex.io/documentation/operators/images/skipWhile.c.png" alt=""></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> example(&quot;skipWhile&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.of(1, 2, 3, 4, 5, 6)</span><br><span class="line">        .skipWhile &#123; $0 &lt; 4 &#125;</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- skipWhile example ---</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td></tr></table></figure>
<p> 同理还有<code>skipWhileWithIndex</code>和<code>skipUntil</code>（禁止发送元素知道参考的序列发送元素）。这里就不一一介绍了。</p>
<h2 id="Mathematical-and-Aggregate"><a href="#Mathematical-and-Aggregate" class="headerlink" title="Mathematical and Aggregate"></a>Mathematical and Aggregate</h2><p>下面几种方法主要是对序列进行集合操作。</p>
<h3 id="toArray"><a href="#toArray" class="headerlink" title="toArray"></a>toArray</h3><p>把可观察的序列转换为数组，然后把整个数组作为一个序列发送，最后终止。<br><img src="http://reactivex.io/documentation/operators/images/to.c.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;toArray&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.range(start: 1, count: 10)</span><br><span class="line">        .toArray()</span><br><span class="line">        .subscribe &#123; print($0) &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- toArray example ---</span><br><span class="line">next([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])</span><br><span class="line">completed</span><br></pre></td></tr></table></figure>
<h3 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a><code>reduce</code></h3><p>这个和swift中的使用方法一样，传入一个初始值，然后每次的结果作为下一次的传入值。最后的结果作为一个序列发送。<br><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/reduce.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;reduce&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    Observable.of(10, 100, 1000)</span><br><span class="line">        .reduce(1, accumulator: +)</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">1111</span><br></pre></td></tr></table></figure>
<h3 id="concat"><a href="#concat" class="headerlink" title="concat"></a><code>concat</code></h3><p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/concat.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;concat&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    </span><br><span class="line">    let subject1 = BehaviorSubject(value: &quot;🍎&quot;)</span><br><span class="line">    let subject2 = BehaviorSubject(value: &quot;🐶&quot;)</span><br><span class="line">    let variable = Variable(subject1)</span><br><span class="line">    </span><br><span class="line">    variable.asObservable()</span><br><span class="line">        .concat()</span><br><span class="line">        .subscribe &#123; print($0) &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">    </span><br><span class="line">    subject1.onNext(&quot;🍐&quot;)</span><br><span class="line">    subject1.onNext(&quot;🍊&quot;)</span><br><span class="line">    variable.value = subject2</span><br><span class="line">    subject2.onNext(&quot;I would be ignored&quot;)</span><br><span class="line">    subject2.onNext(&quot;🐱&quot;)</span><br><span class="line">    subject1.onCompleted()</span><br><span class="line">    subject2.onNext(&quot;🐭&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Error-Handling"><a href="#Error-Handling" class="headerlink" title="Error Handling"></a>Error Handling</h2><p>下面几个操作可以捕获异常事件，并且可以从异常出恢复。</p>
<h3 id="catchErrorJustReturn"><a href="#catchErrorJustReturn" class="headerlink" title="catchErrorJustReturn"></a><code>catchErrorJustReturn</code></h3><p>捕获异常事件，并从异常处恢复，然后发送一个元素，最后终止。<br><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/catch.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;catchErrorJustReturn&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    let sequenceThatFails = PublishSubject&lt;String&gt;()</span><br><span class="line">    </span><br><span class="line">    sequenceThatFails</span><br><span class="line">        .catchErrorJustReturn(&quot;😊&quot;)</span><br><span class="line">        .subscribe &#123; print($0) &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">        </span><br><span class="line">    sequenceThatFails.onNext(&quot;😡&quot;)</span><br><span class="line">    sequenceThatFails.onNext(&quot;🔴&quot;)</span><br><span class="line">    sequenceThatFails.onError(TestError.test)</span><br><span class="line">&#125;</span><br><span class="line">--- catchErrorJustReturn example ---</span><br><span class="line">next(😡)</span><br><span class="line">next(🔴)</span><br><span class="line">next(😊)</span><br><span class="line">completed</span><br></pre></td></tr></table></figure>
<h3 id="catchError"><a href="#catchError" class="headerlink" title="catchError"></a><code>catchError</code></h3><p>捕获异常事件，并从异常处恢复，返回指定的事件序列。<br> <img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/catch.png" alt=""></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> example(&quot;catchError&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    let sequenceThatFails = PublishSubject&lt;String&gt;()</span><br><span class="line">    let recoverySequence = PublishSubject&lt;String&gt;()</span><br><span class="line">    </span><br><span class="line">    sequenceThatFails</span><br><span class="line">        .catchError &#123;</span><br><span class="line">            print(&quot;Error:&quot;, $0)</span><br><span class="line">            return recoverySequence</span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe &#123; print($0) &#125;</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">    </span><br><span class="line">    sequenceThatFails.onNext(&quot;😡&quot;)</span><br><span class="line">    sequenceThatFails.onNext(&quot;🔴&quot;)</span><br><span class="line">    sequenceThatFails.onError(TestError.test)</span><br><span class="line">    recoverySequence.onNext(&quot;😊&quot;)</span><br><span class="line">&#125;</span><br><span class="line">--- catchError example ---</span><br><span class="line">next(😡)</span><br><span class="line">next(🔴)</span><br><span class="line">Error: test</span><br><span class="line">next(😊)</span><br></pre></td></tr></table></figure>
<h3 id="retry"><a href="#retry" class="headerlink" title="retry"></a><code>retry</code></h3><p> 重新尝试，意思就是当异常发生的时候，从头开始发送事件。<br>  <img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/retry.png" alt=""></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">  example(&quot;retry&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    var count = 1</span><br><span class="line">    </span><br><span class="line">    let sequenceThatErrors = Observable&lt;String&gt;.create &#123; observer in</span><br><span class="line">        observer.onNext(&quot;🍎&quot;)</span><br><span class="line">        observer.onNext(&quot;🍐&quot;)</span><br><span class="line">        observer.onNext(&quot;🍊&quot;)</span><br><span class="line">        </span><br><span class="line">        if count == 1 &#123;</span><br><span class="line">            observer.onError(TestError.test)</span><br><span class="line">            print(&quot;Error encountered&quot;)</span><br><span class="line">            count += 1</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        observer.onNext(&quot;🐶&quot;)</span><br><span class="line">        observer.onNext(&quot;🐱&quot;)</span><br><span class="line">        observer.onNext(&quot;🐭&quot;)</span><br><span class="line">        observer.onCompleted()</span><br><span class="line">        </span><br><span class="line">        return Disposables.create()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    sequenceThatErrors</span><br><span class="line">        .retry()</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- retry example ---</span><br><span class="line">🍎</span><br><span class="line">🍐</span><br><span class="line">🍊</span><br><span class="line">Error encountered</span><br><span class="line">🍎</span><br><span class="line">🍐</span><br><span class="line">🍊</span><br><span class="line">🐶</span><br><span class="line">🐱</span><br><span class="line">🐭</span><br></pre></td></tr></table></figure>
<h2 id="Debugging-Operators"><a href="#Debugging-Operators" class="headerlink" title="Debugging Operators"></a>Debugging Operators</h2><p>主要讲调试RX代码的方法。</p>
<h3 id="debug"><a href="#debug" class="headerlink" title="debug"></a><code>debug</code></h3><p>通过这个方法可以在发生错误的时候打印出所有的订阅者，事件等。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;debug&quot;) &#123;</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    var count = 1</span><br><span class="line">    </span><br><span class="line">    let sequenceThatErrors = Observable&lt;String&gt;.create &#123; observer in</span><br><span class="line">        observer.onNext(&quot;🍎&quot;)</span><br><span class="line">        observer.onNext(&quot;🍐&quot;)</span><br><span class="line">        observer.onNext(&quot;🍊&quot;)</span><br><span class="line">        </span><br><span class="line">        if count &lt; 5 &#123;</span><br><span class="line">            observer.onError(TestError.test)</span><br><span class="line">            print(&quot;Error encountered&quot;)</span><br><span class="line">            count += 1</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        observer.onNext(&quot;🐶&quot;)</span><br><span class="line">        observer.onNext(&quot;🐱&quot;)</span><br><span class="line">        observer.onNext(&quot;🐭&quot;)</span><br><span class="line">        observer.onCompleted()</span><br><span class="line">        </span><br><span class="line">        return Disposables.create()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    sequenceThatErrors</span><br><span class="line">        .retry(3)</span><br><span class="line">        .debug()</span><br><span class="line">        .subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">        .addDisposableTo(disposeBag)</span><br><span class="line">&#125;</span><br><span class="line">--- debug example ---</span><br><span class="line">2016-09-24 22:25:47.466: playground73.swift:42 (__lldb_expr_73) -&gt; subscribed</span><br><span class="line">2016-09-24 22:25:47.468: playground73.swift:42 (__lldb_expr_73) -&gt; Event next(🍎)</span><br><span class="line">🍎</span><br><span class="line">2016-09-24 22:25:47.469: playground73.swift:42 (__lldb_expr_73) -&gt; Event next(🍐)</span><br><span class="line">🍐</span><br><span class="line">2016-09-24 22:25:47.469: playground73.swift:42 (__lldb_expr_73) -&gt; Event next(🍊)</span><br><span class="line">🍊</span><br><span class="line">Error encountered</span><br><span class="line">2016-09-24 22:25:47.472: playground73.swift:42 (__lldb_expr_73) -&gt; Event next(🍎)</span><br><span class="line">🍎</span><br><span class="line">2016-09-24 22:25:47.472: playground73.swift:42 (__lldb_expr_73) -&gt; Event next(🍐)</span><br><span class="line">🍐</span><br><span class="line">2016-09-24 22:25:47.472: playground73.swift:42 (__lldb_expr_73) -&gt; Event next(🍊)</span><br><span class="line">🍊</span><br><span class="line">Error encountered</span><br><span class="line">2016-09-24 22:25:47.474: playground73.swift:42 (__lldb_expr_73) -&gt; Event next(🍎)</span><br><span class="line">🍎</span><br><span class="line">2016-09-24 22:25:47.474: playground73.swift:42 (__lldb_expr_73) -&gt; Event next(🍐)</span><br><span class="line">🍐</span><br><span class="line">2016-09-24 22:25:47.475: playground73.swift:42 (__lldb_expr_73) -&gt; Event next(🍊)</span><br><span class="line">🍊</span><br><span class="line">Error encountered</span><br><span class="line">2016-09-24 22:25:47.477: playground73.swift:42 (__lldb_expr_73) -&gt; Event error(test)</span><br><span class="line">Received unhandled error: /var/folders/49/3_69hmqj64j4g5p0pz56w72h0000gn/T/./lldb/25555/playground73.swift:43:__lldb_expr_73 -&gt; test</span><br><span class="line">2016-09-24 22:25:47.491: playground73.swift:42 (__lldb_expr_73) -&gt; isDisposed</span><br><span class="line">2016-09-24 22:25:47.491: playground73.swift:42 (__lldb_expr_73) -&gt; isDisposed</span><br></pre></td></tr></table></figure>
<h3 id="RxSwift-resourceCount"><a href="#RxSwift-resourceCount" class="headerlink" title="RxSwift.resourceCount"></a><code>RxSwift.resourceCount</code></h3><p>RXSwift还提供了查看当前穿件的所有RX资源个数的方法，通过这个方法可以有效的调试泄露问题。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;RxSwift.resourceCount&quot;) &#123;</span><br><span class="line">    print(RxSwift.resourceCount)</span><br><span class="line">    let disposeBag = DisposeBag()</span><br><span class="line">    print(RxSwift.resourceCount)</span><br><span class="line">    let variable = Variable(&quot;🍎&quot;)</span><br><span class="line">    let subscription1 = variable.asObservable().subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">    </span><br><span class="line">    print(RxSwift.resourceCount)</span><br><span class="line">    </span><br><span class="line">    let subscription2 = variable.asObservable().subscribe(onNext: &#123; print($0) &#125;)</span><br><span class="line">    </span><br><span class="line">    print(RxSwift.resourceCount)</span><br><span class="line">    subscription1.dispose()</span><br><span class="line">    print(RxSwift.resourceCount)</span><br><span class="line">    subscription2.dispose()</span><br><span class="line">    print(RxSwift.resourceCount)</span><br><span class="line">&#125;</span><br><span class="line">print(RxSwift.resourceCount)</span><br><span class="line">--- RxSwift.resourceCount example ---</span><br><span class="line">0</span><br><span class="line">1</span><br><span class="line">🍎</span><br><span class="line">4</span><br><span class="line">🍎</span><br><span class="line">6</span><br><span class="line">5</span><br><span class="line">4</span><br><span class="line">0</span><br></pre></td></tr></table></figure>
<p><code>RxSwift.resourceCount</code>并不是默认开启的，在release模式下请不要开启它。通过下面2种方法可以在开发的时候开启：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">**CocoaPods**</span><br><span class="line"> 1. Add a `post_install` hook to your Podfile, e.g.:</span><br><span class="line"> </span><br><span class="line"> target &apos;AppTarget&apos; do</span><br><span class="line"> pod &apos;RxSwift&apos;</span><br><span class="line"> end</span><br><span class="line"> </span><br><span class="line"> post_install do |installer|</span><br><span class="line">     installer.pods_project.targets.each do |target|</span><br><span class="line">         if target.name == &apos;RxSwift&apos;</span><br><span class="line">             target.build_configurations.each do |config|</span><br><span class="line">                 if config.name == &apos;Debug&apos;</span><br><span class="line">                     config.build_settings[&apos;OTHER_SWIFT_FLAGS&apos;] ||= [&apos;-D&apos;, &apos;TRACE_RESOURCES&apos;]</span><br><span class="line">                 end</span><br><span class="line">             end</span><br><span class="line">         end</span><br><span class="line">     end</span><br><span class="line"> end</span><br><span class="line"> </span><br><span class="line"> 2. Run `pod update`.</span><br><span class="line"> 3. Build project (**Product** → **Build**).</span><br><span class="line"> #</span><br><span class="line"> **Carthage**</span><br><span class="line"> 1. Run `carthage build --configuration Debug`.</span><br><span class="line"> 2. Build project (**Product** → **Build**).</span><br></pre></td></tr></table></figure>
<p>文档更新中，写的不足的地方请谅解，您也可以留下您宝贵的意见，谢谢~~~</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/images/wechat-reward-image.jpg" alt="jamy_gu WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="/images/alipay-reward-image.jpg" alt="jamy_gu Alipay"/>
          <p>支付宝打赏</p>
        </div>
      
    </div>
  </div>


      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/swift/" rel="tag"># swift</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/09/20/swift-Sequence-map-flatmap/" rel="next" title="swift Sequence及map，flatmap的实现">
                <i class="fa fa-chevron-left"></i> swift Sequence及map，flatmap的实现
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/05/08/iOS-block/" rel="prev" title="iOS block内部实现分析">
                iOS block内部实现分析 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="jamy_gu" />
          <p class="site-author-name" itemprop="name">jamy_gu</p>
           
              <p class="site-description motion-element" itemprop="description">Stay hungry，Stay foolish！</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/svenJamy" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/1805553781/profile?topnav=1&wvr=6" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Introduction"><span class="nav-number">1.</span> <span class="nav-text">Introduction</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Why-RXswift"><span class="nav-number">1.1.</span> <span class="nav-text">Why RXswift</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Concepts"><span class="nav-number">1.2.</span> <span class="nav-text">Concepts</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建和订阅Observable"><span class="nav-number">2.</span> <span class="nav-text">创建和订阅Observable</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#never"><span class="nav-number">2.1.</span> <span class="nav-text">never</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#empty"><span class="nav-number">2.2.</span> <span class="nav-text">empty</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#just"><span class="nav-number">2.3.</span> <span class="nav-text">just</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#of"><span class="nav-number">2.4.</span> <span class="nav-text">of</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#from"><span class="nav-number">2.5.</span> <span class="nav-text">from</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#create"><span class="nav-number">2.6.</span> <span class="nav-text">create</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#range"><span class="nav-number">2.7.</span> <span class="nav-text">range</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#repeatElement"><span class="nav-number">2.8.</span> <span class="nav-text">repeatElement</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#generate"><span class="nav-number">2.9.</span> <span class="nav-text">generate</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#deferred"><span class="nav-number">2.10.</span> <span class="nav-text">deferred</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#error"><span class="nav-number">2.11.</span> <span class="nav-text">error</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Subjects"><span class="nav-number">3.</span> <span class="nav-text">Subjects</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#PublishSubject"><span class="nav-number">3.1.</span> <span class="nav-text">PublishSubject</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ReplaySubject"><span class="nav-number">3.2.</span> <span class="nav-text">ReplaySubject</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BehaviorSubject"><span class="nav-number">3.3.</span> <span class="nav-text">BehaviorSubject</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Variable"><span class="nav-number">3.4.</span> <span class="nav-text">Variable</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Combination-Operators"><span class="nav-number">4.</span> <span class="nav-text">Combination Operators</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#startWith"><span class="nav-number">4.1.</span> <span class="nav-text">startWith</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#merge"><span class="nav-number">4.2.</span> <span class="nav-text">merge</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#zip"><span class="nav-number">4.3.</span> <span class="nav-text">zip</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#combineLatest"><span class="nav-number">4.4.</span> <span class="nav-text">combineLatest</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#switchLatest"><span class="nav-number">4.5.</span> <span class="nav-text">switchLatest</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Transforming-Operators"><span class="nav-number">5.</span> <span class="nav-text">Transforming Operators</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#map"><span class="nav-number">5.1.</span> <span class="nav-text">map</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flatMap和flatMapLatest"><span class="nav-number">5.2.</span> <span class="nav-text">flatMap和flatMapLatest</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#scan"><span class="nav-number">5.3.</span> <span class="nav-text">scan</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Filtering-and-Conditional"><span class="nav-number">6.</span> <span class="nav-text">Filtering and Conditional</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#filter"><span class="nav-number">6.1.</span> <span class="nav-text">filter</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#distinctUntilChanged"><span class="nav-number">6.2.</span> <span class="nav-text">distinctUntilChanged</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#elementAt"><span class="nav-number">6.3.</span> <span class="nav-text">elementAt</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#single"><span class="nav-number">6.4.</span> <span class="nav-text">single</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#take"><span class="nav-number">6.5.</span> <span class="nav-text">take</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#takeLast"><span class="nav-number">6.6.</span> <span class="nav-text">takeLast</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#takeWhile"><span class="nav-number">6.7.</span> <span class="nav-text">takeWhile</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#takeUntil"><span class="nav-number">6.8.</span> <span class="nav-text">takeUntil</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#skip"><span class="nav-number">6.9.</span> <span class="nav-text">skip</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#skipWhile"><span class="nav-number">6.10.</span> <span class="nav-text">skipWhile</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Mathematical-and-Aggregate"><span class="nav-number">7.</span> <span class="nav-text">Mathematical and Aggregate</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#toArray"><span class="nav-number">7.1.</span> <span class="nav-text">toArray</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reduce"><span class="nav-number">7.2.</span> <span class="nav-text">reduce</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#concat"><span class="nav-number">7.3.</span> <span class="nav-text">concat</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Error-Handling"><span class="nav-number">8.</span> <span class="nav-text">Error Handling</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#catchErrorJustReturn"><span class="nav-number">8.1.</span> <span class="nav-text">catchErrorJustReturn</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#catchError"><span class="nav-number">8.2.</span> <span class="nav-text">catchError</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#retry"><span class="nav-number">8.3.</span> <span class="nav-text">retry</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Debugging-Operators"><span class="nav-number">9.</span> <span class="nav-text">Debugging Operators</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#debug"><span class="nav-number">9.1.</span> <span class="nav-text">debug</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RxSwift-resourceCount"><span class="nav-number">9.2.</span> <span class="nav-text">RxSwift.resourceCount</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">jamy.gush</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://jamy-gu.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://yoursite.com/2016/09/24/RxSwift-introduce/';
          this.page.identifier = '2016/09/24/RxSwift-introduce/';
          this.page.title = 'RxSwift系列笔记-入门';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://jamy-gu.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  













  





  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  

</body>
</html>
